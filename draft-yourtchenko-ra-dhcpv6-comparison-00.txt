


Network Working Group                                     A. Yourtchenko
Internet-Draft                                                     cisco
Intended status: Informational                          October 29, 2013
Expires: April 30, 2014

    A comparison between the DHCPv6  and RA based host configuration
               draft-yourtchenko-ra-dhcpv6-comparison-00

Abstract

   This document attempts to make a balanced comparison between the RA-
   based and DHCPv6-based host configuration mechanisms.  It compares
   the two on different aspects - like, underlying media assumptions,
   coordination, locality, etc.  and highlights the strong and weak
   sides of both for each scenario.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 30, 2014.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (http://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Simplified BSD License text
   as described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Simplified BSD License.

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  2
   2.  Comparison . . . . . . . . . . . . . . . . . . . . . . . . . .  2
     2.1.  Interworking with different L2 topologies  . . . . . . . .  2

Yourtchenko              Expires April 30, 2014                 [Page 1]

Internet-Draft          RA and DHCPv6 comparison            October 2013

     2.2.  Acknowledged vs. Unacknowledged  . . . . . . . . . . . . .  3
     2.3.  Client initiated vs. server initiated  . . . . . . . . . .  3
     2.4.  Centralized coordination vs. distributed coordination  . .  3
     2.5.  Single Source of Truth vs. Multiple sources  . . . . . . .  4
     2.6.  The amount of server-side state  . . . . . . . . . . . . .  4
     2.7.  Involvement or not into routing  . . . . . . . . . . . . .  5
     2.8.  Server locality  . . . . . . . . . . . . . . . . . . . . .  5
     2.9.  Programming: UDP vs. ICMP  . . . . . . . . . . . . . . . .  6
     2.10. Separate vs. unified management  . . . . . . . . . . . . .  6
   3.  Arguments for running only a single protocol . . . . . . . . .  7
     3.1.  Support and Security Complexity  . . . . . . . . . . . . .  7
   4.  Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . .  7
   5.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  7
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  7
   7.  Security Considerations  . . . . . . . . . . . . . . . . . . .  7
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  7
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . .  7

1.  Introduction

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   This document is being discussed on the xyz@example.org mailing list.

   Add some text here.  You will need to use these references somewhere
   within the text:

2.  Comparison

2.1.  Interworking with different L2 topologies

   RA is "server-initiated, send once, receive many, no confirmation"
   abstraction - something that works well on the 10base2-type shared
   bus and even the today's wired ethernet, but looks quite miserable on
   the WiFi media without the special tricks (802.11 provides reliable
   delivery for unicast frames, and does not provide one for multicast
   frames, also the physical speeds are different and even the
   contention management and the speed/modulation can be different as
   well).

   DHCPv6 is "client-initiated, send once, receive once, confirmation"
   abstraction.  This may be wasteful on the low-bandwidth links that
   provide bus topology, but maps extremely well onto scenarios like
   WiFi - as it allows to maintain somewhat familiar mode of operation
   to wired ethernet.

   This is where the p2p, acknowledged nature of DHCPv6 may be
   beneficial - on a crowded large-scale WiFi, without dirty tricks, you
   simply will not get the SLAAC working because the multicast RAs will
   get crunched by the interference.





Yourtchenko              Expires April 30, 2014                 [Page 2]

Internet-Draft          RA and DHCPv6 comparison            October 2013


   Alternatively, in a very mobile environment and the RFC-compliant
   router, multicast solicited RAs might make a significant portion of
   your traffic - which, due to a difference in modulation, etc.  may
   eat way more bandwidth than if they were sent unicast.

2.2.  Acknowledged vs.  Unacknowledged

   DHCPv6 needs at least 2 packets.  RA is just one packet.

   RA strength: it is quicker; RA weakness: you have to take care that
   it is legitimate router and not your evil neighbor sending you the
   RAs you take the configuration from.

   DHCPv6 Plus: works well in the noisy/lossy environments; DHCPv6
   minus: takes at least 1 RTT to the server.  The necessity for the
   multiple packets exchange does not obviate the need for the securing
   DHCPv6 in a similar fashion.

2.3.  Client initiated vs.  server initiated

   Despite the division above, RA can be client-initiated, to some
   extent, with RS, and DHCPv6 can be server-initiated, to some extent,
   with "Reconfigure" messages.

   If we treat these as "nudge" messages, the behavior of the sending
   and receiving parties is similar - the "nudge" message causes the
   orderly protocol exchange to occur before the due time.

   The part that is different, though, is that RA, due to its "send
   once, receive many" nature, can aggregate the "nudge" messages, so
   intuitively seems best for a scenario with a very large number of the
   hosts, as it should have self-stabilizing properties, compared to
   DHCPv6.

   This "self-stabilizing" property intuitively seems to make RA safer
   to use, IFF it is used in purely "multicast" fashion.  However, the
   L2 media interaction concerns might affect and even cancel out this
   property, depending on the environment.

2.4.  Centralized coordination vs.  distributed coordination

   RA, due to its "send once, receive many" nature, in its pure form
   necessarily can not dictate a per-client settings, but rather can
   only advise the domain the client would pick from (SLAAC).

   DHCPv6 on the other hand, due to its p2p nature is by default well
   suited for the individual per-client tweaking.

   The distributed nature can be a blessing if you do not care about who
   gets which address and a curse if you need to account everyone
   strictly.



Yourtchenko              Expires April 30, 2014                 [Page 3]

Internet-Draft          RA and DHCPv6 comparison            October 2013


   NB: address assignment does not mean that the hosts will always use
   those addresses - e.g.  it's perfectly possible to statically
   configure a different address, but we talk just homogenous standards-
   compliant well-behaved hosts for simplicity sake).

   That's why the title of this section does not use the word "control"
   but rather uses the word "coordination".

2.5.  Single Source of Truth vs.  Multiple sources

   The DHCPv6 model requires the client to choose only one of the
   advertise messages that it receives.  When using RA, the client can
   combine information from multiple sources.

   This section is quite intertwined with the previous one (distributed/
   centralized), and the reasoning for when a particular protocol is
   "good" or "bad" will be similar - RA based configuration will be best
   in case the networks are not under administration, and the hosts are
   given a lot of flexibility.

   On the other hand, DHCPv6 will be useful for the case where there is
   a need to tightly control the behavior of the hosts and have a highly
   predictable configuration of the network as a whole.  Of course, as a
   tradeoff such predictability brings potentially increased fragility.

   An example where this difference might be crucial is a segment with
   two servers, aware of each other state.  If server A goes down, then
   server B, when using RA-based mechanism, can just send a message with
   the lifetime of zero.  The DHCPv6-based implementation of this
   scenario would need to be more involved - if the client trusted the
   server A to begin with, it will not listen to notifications from B -
   so B will need to spoof A in some way.

   However, at the same time this ease with which one device can
   instruct the hosts on behalf of the other can be also considered a
   weakness in a stricter environment - and require additional security
   measures in place so that a malicious host did not impersonate a
   router.

2.6.  The amount of server-side state

   RA in its pure form is inherently stateless - there is no per-client
   information stored on the sending router.  This eases the things like
   redundancy and failover compared to DHCPv6.

   DHCPv6 in its stateless incarnation also does not keep the state -
   however, in the scenario of the DHCPv6 server sending the RECONFIGURE
   message to the client, DHCPv6 server must keep some knowledge of the
   client - which means it might need to keep some state.

   [FIXME] Further experimentation needed to test how it actually works



Yourtchenko              Expires April 30, 2014                 [Page 4]

Internet-Draft          RA and DHCPv6 comparison            October 2013

   in real life implementations.

   jinmei@wide.ad.jp: If you mean the Delayed Authentication Protocol by
   DHCPv6 authentication, the WIDE DHCPv6 supports it: http://
   sourceforge.net/projects/wide-dhcpv6/ although I myself have only
   used it in testing.  I heard some other vendors implemented it, too.
   (And, for that matter, it also supports the Information Refresh Time
   option (RFC4242)).

2.7.  Involvement or not into routing

   An RA-based protocol interaction may influence host's routing.  A
   DHCPv6-based interaction today can not influence the host's routing -
   it was specifically denied any and all involvement into routing.

   RAs as a mechanism, due to its "multiple sources of truth" nature,
   can allow unsophisticated form of routing resiliency for the hosts.

   While architecturally "pure", the reliability and timing of the
   routing resiliency provided by the RAs is far below those achieved by
   FHRP protocols - which makes the "distributed routing for
   unsophisticated hosts" property unusable in the most networks.

   With this, the role of the RAs is reduced to just supplying the
   default gateway (and maybe some static routes) - something that is
   successfully done by DHCPv4 today.  This creates an impression that
   adding this functionality to DHCPv6 would allow to get rid of the RA
   completely for that use case.

   However, the "single source of truth" nature of DHCPv6 prevents the
   successful operation in case of multiple servers on the segment
   supplying different information.  RAs in this case may still work.

   Some consider the inability to support this scenario crucial, and
   some think it is not useful.  This creates contention between the
   proponents of those who want DHCPv6 deal with routing, and those who
   think RA is the single possible candidate for that.

   The other aspect is that because RA ties in the routing and
   addressing information, one can say "RA shares the fate with
   routing".  However, this distinction is merely because of the
   decision to explicitly keep DHCPv6 away from routing - so can not be
   considered a true property of the protocol.

   brian@innovationslab.net: you do not know that the DHCPv6 message you
   received came from a router or a server.

   [FIXME]: This section needs further debates, clarifications, and a
   rewrite.  I am not sure I correctly captured the essence.  The
   arguments are welcome!





Yourtchenko              Expires April 30, 2014                 [Page 5]

Internet-Draft          RA and DHCPv6 comparison            October 2013

2.8.  Server locality

   Both DHCPv6 and RA are inherently link-local mechanisms, however
   DHCPv6 has a means to "jump" over multiple hops by use of the relays.
   This means RA *has* to be distributed, while DHCPv6 can be both
   centralized and distributed.  Frequently it is made centralized
   because of other benefits that centralized administration brings, but
   almost any router today can run a DHCPv6 server itself with very
   little problem.

2.9.  Programming: UDP vs.  ICMP

   For a random programmer today, coding a server to receive the data on
   a UDP socket is a more familiar exercise than working with ICMP.
   Disclaimer: the value of "random" was chosen to be "me" for arbitrary
   reasons.

   This point is more of a rathole and a personal preference, probably.
   [FIXME] In Windows one of the two was way easier to extend than the
   other, but I do not remember which.

   lorenzo@google.com:  ICMP is harder than UDP to implement; it often
   requires raw sockets or kernel collaboration (e.g., on Linux RDNSS
   information can be read using netlink.  UDP is much simpler). On the
   other hand, I think stateful DHCPv6 is a more complicated protocol to
   implement than RAs, with more message types and so on.

   jinmei@wide.ad.jp: I don't know why Linux uses a non portable API,
   but I believe writing programs handling RA options like RDNSS is no
   harder than writing DHCPv6 client in terms of socket API.  As long as
   the system supports RFC3542 you should be able to write a portable RA
   "client" pretty easily (meaning as easy/hard as writing some UDP
   client program).  For example, FreeBSD's rtsold supports RDNSS and
   (AFAIK) only relies on the RFC3542 APIs.  Also, since DHCP is
   trickier than other UDP applications in some points (it's more
   sensitive to which interface to use, and in some cases you need to
   make sure the source address is link-local, etc), it's quite likely
   that you'll need something like unusual APIs like RFC3542 or some
   non-portable system dependent interface to write a standard-compliant
   DHCP(v6) client.  So, overall, I'd say the programming difficulty
   regarding UDP (DHCP) vs ICMP (RS/RA) is marginal.

2.10.  Separate vs.  unified management

   If DHCPv4 and routing is managed by the different groups in the
   organization, then conceivably the "server" people will not like to
   have their work go away and similarly "router" guys are happy to get
   rid of yet another point of coordination and argument.

   This is where the "I hate $protocol" could definitely pop up -
   because for one side it may be the media interworking that is a
   crucial factor, while for the other side it is the amount of state
   held on the server - thus the agreement would never be achieved
   because they are arguing about different things.

Yourtchenko              Expires April 30, 2014                 [Page 6]

Internet-Draft          RA and DHCPv6 comparison            October 2013


3.  Arguments for running only a single protocol

   The "Comparison" section aims to highlight the various differences,
   and implicitly show the reasoning to have two protocols implemented
   in the nodes.  This section enumerates the reasons for a network
   operator to strongly prefer having only one of these two protocols in
   operation on the network at any point in time.

3.1.  Support and Security Complexity

   nick@inex.ie: this brings up another important issue, namely source
   address validation.  I'm not sure if it's relevant to bring this up
   in your draft, but the requirement to handle snooping two new
   protocols for effective lan source address validation seems to be
   more than most vendors can handle at the moment, which means that as
   operators we are very exposed to rogue RAs and rogue DHCPv6 packets
   flying around networks.

4.  Conclusion

   This document has attempted to show that both DHCPv6 and RA based
   configuration mechanisms have their unique strengths and weaknesses,
   and each of them may be "the best" depending on the environment for a
   particular network.

   Therefore, the host stacks which expect to maximize their chances of
   connectivity when moving between different networks, will achieve
   this best by implementing both mechanisms - else they might end
   lacking essential configuration parameters if the network supports
   the mechanism of not their choosing.

   The networks may adopt a similar approach of attempting to support
   both mechanisms at once, to try to accomodate the "single-minded"
   hosts - but doing so usually incurs the overhead, which should be
   evaluated by the network administrators.

5.  Acknowledgements

   Thanks to Ted Lemon for triggering the creation of this document.

   Thanks to Lorenzo Colitti for the valuable discussion about the
   server-side state and the client-server initiated interactions.

6.  IANA Considerations

7.  Security Considerations

8.  References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

Author's Address

Yourtchenko              Expires April 30, 2014                 [Page 7]

Internet-Draft          RA and DHCPv6 comparison            October 2013


   Andrew
   cisco
   7a de Kleetlaan
   Diegem, 1830
   Belgium
   
   Phone: +32 2 704 5494
   Email: ayourtch@cisco.com













































Yourtchenko              Expires April 30, 2014                 [Page 8]
